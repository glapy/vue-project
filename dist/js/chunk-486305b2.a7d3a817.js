(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-486305b2"],{"6c5a":function(e,t,a){},9557:function(e,t,a){"use strict";a("6c5a")},cf2a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orders,stripe:"","max-height":"1000px"}},[a("el-table-column",{attrs:{width:"30",fixed:""}}),a("el-table-column",{attrs:{prop:"commodityId",label:"商品ID",width:"80",fixed:""}}),a("el-table-column",{attrs:{prop:"commodityName",label:"商品名称",width:"200",fixed:""}}),a("el-table-column",{attrs:{prop:"quantity",label:"数量",width:"80"}}),a("el-table-column",{attrs:{prop:"amount",label:"总价",width:"100"}}),a("el-table-column",{attrs:{prop:"creatTime",label:"订单开始时间",width:"200"}}),a("el-table-column",{attrs:{prop:"endTime",label:"订单结束时间",width:"200"}}),a("el-table-column",{attrs:{prop:"userAddressName",label:"收货人",width:"100"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"120"}}),a("el-table-column",{attrs:{prop:"address",label:"收货地址",width:"160"}}),a("el-table-column",{attrs:{prop:"status",label:"标签",width:"140",filters:[{text:"待支付",value:0},{text:"取消订单",value:1},{text:"待发货",value:2},{text:"已收货",value:4},{text:"退货审核中",value:5},{text:"已退货",value:6},{text:"拒绝退货",value:7},{text:"已完成",value:8}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:8===t.row.status?"success":"primary","disable-transitions":""}},[e._v(e._s(e._f("formatStatus")(t.row.status)))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.determineType(t.row.status,"付款")?a("el-button",{staticClass:"pay",attrs:{size:"mini"},on:{click:function(a){return e.handlePay(t.row)}}},[e._v("付款")]):e._e(),e.determineType(t.row.status,"取消订单")?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleCancelPay(t.row)}}},[e._v("取消订单")]):e._e(),e.determineType(t.row.status,"退货")?a("el-button",{staticClass:"backup",attrs:{size:"mini"},on:{click:function(a){return e.handleReturnGoods(t.row)}}},[e._v("退货")]):e._e(),e.determineType(t.row.status,"确认订单")?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleConfirm(t.row)}}},[e._v("确认订单")]):e._e(),e.determineType(t.row.status,"取消退货")?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleCancelReturn(t.row)}}},[e._v("取消退货")]):e._e()]}}])})],1)],1)},r=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("a481"),a("ade3")),o=a("2f62");function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"order",data:function(){return{orders:[]}},created:function(){var e=this;this.axios.get("/order/user/"+this.user.id,{params:{page:1}}).then((function(t){200==t.status&&(e.orders=t.data.data.records)}))},computed:c({},Object(o["e"])("user",["user"])),methods:{filterTag:function(e,t){return t.status===e},handlePay:function(e){this.axios.post("/order/pay",e).then((function(t){e.status=2;var a=document.getElementsByTagName("div");a.length&&document.body.removeChild(a[0]);var n=document.createElement("div");n.innerHTML=t.data,document.body.appendChild(n),document.forms[0].submit()})).catch((function(){}))},handleCancelPay:function(e){var t=this;this.$confirm("确认取消清单?").then((function(){var a=e.status;e.status=1;var n=e.endTime;e.endTime=t.formatDate(new Date,"YY-MM-DD hh:mm:ss"),t.axios.post("/order/update",e).then((function(r){0==r.data.code?t.$message({type:"success",message:"取消订单成功！"}):(t.$message(r.data.msg),e.status=a,e.endTime=n)})).catch((function(){}))})).catch((function(){}))},handleReturnGoods:function(e){var t=this;this.$confirm("确认提交退货申请?").then((function(){var a=e.status;e.status=5,t.axios.post("/order/update",e).then((function(n){0==n.data.code?t.$message({type:"success",message:"申请退货成功，请等待商家回应！"}):(t.$message(n.data.msg),e.status=a)})).catch((function(){}))})).catch((function(){}))},handleCancelReturn:function(e){var t=this;this.$confirm("确认取消退货? 确认后订单不能再次退货！").then((function(){var a=e.status;e.status=8;var n=e.endTime;e.endTime=t.formatDate(new Date,"YY-MM-DD hh:mm:ss"),t.axios.post("/order/update",e).then((function(r){0==r.data.code?t.$message({type:"success",message:"取消退货成功，该订单已完成！"}):(t.$message(r.data.msg),e.status=a,e.endTime=n)})).catch((function(){}))})).catch((function(){}))},handleConfirm:function(e){var t=this;this.$confirm("确认订单已完成？").then((function(){var a=e.status;e.status=8;var n=e.endTime;e.endTime=t.formatDate(new Date,"YY-MM-DD hh:mm:ss"),t.axios.post("/order/update",e).then((function(r){0==r.data.code?t.$message({type:"success",message:"确认成功，该订单已完成！"}):(t.$message(r.data.msg),e.status=a,e.endTime=n)})).catch((function(){}))})).catch((function(){}))},determineType:function(e,t){if("付款"==t){if(0==e)return!0}else if("取消订单"==t){if(0==e)return!0}else if("退货"==t){if(4==e||3==e||2==e)return!0}else if("取消退货"==t){if(5==e)return!0}else if(4==e||6==e||3==e)return!0;return!1},formatDate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YY-MM-DD hh:mm:ss",a=new Date(e),n=a.getFullYear(),r=a.getMonth()+1,s=a.getDate(),o=a.getHours(),i=a.getMinutes(),c=a.getSeconds(),u=Array.apply(null,Array(10)).map((function(e,t){return"0"+t})),l=t.replace(/YY/g,n).replace(/MM/g,u[r]||r).replace(/DD/g,u[s]||s).replace(/hh/g,u[o]||o).replace(/mm/g,u[i]||i).replace(/ss/g,u[c]||c);return l}},filters:{formatStatus:function(e){var t="";switch(e){case 0:t="待支付";break;case 1:t="已取消";break;case 2:t="待发货";break;case 3:t="运输中";break;case 4:t="已收货";break;case 5:t="退货审核中";break;case 6:t="已退货";break;case 7:t="拒绝退货";break;case 8:t="已完成";break}return t}}},l=u,d=(a("9557"),a("2877")),m=Object(d["a"])(l,n,r,!1,null,"bf1748b0",null);t["default"]=m.exports}}]);